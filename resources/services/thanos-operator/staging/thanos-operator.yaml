apiVersion: template.openshift.io/v1
kind: Template
metadata:
  creationTimestamp: null
  name: thanos-operator
objects:
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosStore
  metadata:
    creationTimestamp: null
    name: default
    namespace: rhobs-stage
  spec:
    blockConfig:
      blockDiscoveryStrategy: concurrent
      blockFilesConcurrency: 1
      blockMetaFetchConcurrency: 32
    ignoreDeletionMarksDelay: 24h
    image: quay.io/thanos/thanos:v0.37.2
    imagePullPolicy: IfNotPresent
    indexHeaderConfig:
      enableLazyReader: true
      lazyDownloadStrategy: lazy
      lazyReaderIdleTimeout: 5m
    logFormat: logfmt
    logLevel: info
    maxTime: -22h
    objectStorageConfig:
      key: thanos.yaml
      name: default-objectstorage
      optional: false
    shardingStrategy:
      shardReplicas: 2
      shards: 3
      type: block
    storageSize: 50GiB
    storeLimitsOptions: {}
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosCompact
  metadata:
    creationTimestamp: null
    name: rhobs
    namespace: rhobs-stage
  spec:
    compactConfig:
      compactConcurrency: 1
    debugConfig:
      acceptMalformedIndex: true
      haltOnError: true
      maxCompactionLevel: 3
    downsamplingConfig:
      downsamplingConcurrency: 1
      downsamplingEnabled: false
    objectStorageConfig:
      key: thanos.yaml
      name: default-objectstorage
      optional: false
    retentionConfig:
      fiveMinutes: 365d
      oneHour: 365d
      raw: 365d
    storageSize: ""
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosCompact
  metadata:
    creationTimestamp: null
    name: rhobs
    namespace: rhobs-stage
  spec:
    compactConfig:
      compactConcurrency: 1
    debugConfig:
      acceptMalformedIndex: true
      haltOnError: true
      maxCompactionLevel: 3
    downsamplingConfig:
      downsamplingConcurrency: 1
      downsamplingEnabled: false
    objectStorageConfig:
      key: thanos.yaml
      name: telemeter-objectstorage
      optional: false
    retentionConfig:
      fiveMinutes: 365d
      oneHour: 365d
      raw: 365d
    storageSize: ""
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosQuery
  metadata:
    creationTimestamp: null
    name: rhobs
    namespace: rhobs-stage
  spec:
    customStoreLabelSelector:
      matchLabels:
        app.kubernetes.io/part-of: thanos
        operator.thanos.io/store-api: "true"
    grpcProxyStrategy: lazy
    image: quay.io/thanos/thanos:v0.37.2
    imagePullPolicy: IfNotPresent
    logFormat: logfmt
    logLevel: info
    queryFrontend:
      compressResponses: true
      image: quay.io/thanos/thanos:v0.37.2
      imagePullPolicy: IfNotPresent
      labelsDefaultTimeRange: 336h
      labelsMaxRetries: 3
      labelsSplitInterval: 24h
      logFormat: logfmt
      logLevel: info
      logQueriesLongerThan: 10s
      queryLabelSelector:
        matchLabels:
          operator.thanos.io/query-api: "true"
      queryRangeMaxRetries: 3
      queryRangeSplitInterval: 24h
      replicas: 3
    replicaLabels:
    - prometheus_replica
    - replica
    - rule_replica
    replicas: 6
    telemetryQuantiles:
      duration:
      - "0.1"
      - "0.25"
      - "0.75"
      - "1.25"
      - "1.75"
      - "2.5"
      - "3"
      - "5"
      - "10"
      - "15"
      - "30"
      - "60"
      - "120"
    webConfig:
      prefixHeader: X-Forwarded-Prefix
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosReceive
  metadata:
    creationTimestamp: null
    name: rhobs
    namespace: rhobs-stage
  spec:
    ingesterSpec:
      defaultObjectStorageConfig:
        key: thanos.yaml
        name: telemeter-objectstorage
        optional: false
      hashrings:
      - asyncForwardWorkerCount: 50
        externalLabels:
          replica: $(POD_NAME)
        image: quay.io/thanos/thanos:v0.37.2
        imagePullPolicy: IfNotPresent
        logFormat: logfmt
        logLevel: info
        name: telemeter
        replicas: 15
        storageSize: 100GiB
        storeLimitsOptions:
          storeLimitsRequestSamples: 627040000
          storeLimitsRequestSeries: 1000000
        tenancyConfig:
          defaultTenantID: FB870BF3-9F3A-44FF-9BF7-D7A047A52F43
          tenantHeader: THANOS-TENANT
          tenantLabelName: tenant_id
          tenantMatcherType: exact
        tooFarInFutureTimeWindow: 5m
        tsdbConfig:
          retention: 4h
      - asyncForwardWorkerCount: 5
        externalLabels:
          replica: $(POD_NAME)
        image: quay.io/thanos/thanos:v0.37.2
        imagePullPolicy: IfNotPresent
        logFormat: logfmt
        logLevel: info
        name: default
        objectStorageConfig:
          key: thanos.yaml
          name: default-objectstorage
          optional: false
        replicas: 6
        storageSize: 50GiB
        storeLimitsOptions: {}
        tenancyConfig:
          defaultTenantID: FB870BF3-9F3A-44FF-9BF7-D7A047A52F43
          tenantHeader: THANOS-TENANT
          tenantLabelName: tenant_id
          tenantMatcherType: exact
        tooFarInFutureTimeWindow: 5m
        tsdbConfig:
          retention: 1d
    routerSpec:
      externalLabels:
        receive: "true"
      image: quay.io/thanos/thanos:v0.37.2
      imagePullPolicy: IfNotPresent
      logFormat: logfmt
      logLevel: info
      replicas: 6
      replicationFactor: 3
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosRuler
  metadata:
    creationTimestamp: null
    name: rhobs
    namespace: rhobs-stage
  spec:
    alertLabelDrop:
    - rule_replica
    alertmanagerURL: dnssrv+http://alertmanager-cluster.rhobs-stage.svc.cluster.local:9093
    defaultObjectStorageConfig:
      key: thanos.yaml
      name: default-objectstorage
      optional: false
    evaluationInterval: 1m
    externalLabels:
      rule_replica: $(NAME)
    image: quay.io/thanos/thanos:v0.37.2
    imagePullPolicy: IfNotPresent
    logFormat: logfmt
    logLevel: info
    prometheusRuleSelector:
      matchLabels:
        operator.thanos.io/prometheus-rule: "true"
    queryLabelSelector:
      matchLabels:
        app.kubernetes.io/part-of: thanos
        operator.thanos.io/query-api: "true"
    replicas: 2
    retention: 48h
    ruleConfigSelector:
      matchLabels:
        operator.thanos.io/rule-file: "true"
    storageSize: 50GiB
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosStore
  metadata:
    creationTimestamp: null
    name: telemeter-0to2w
    namespace: rhobs-stage
  spec:
    blockConfig:
      blockDiscoveryStrategy: concurrent
      blockFilesConcurrency: 1
      blockMetaFetchConcurrency: 32
    ignoreDeletionMarksDelay: 24h
    image: quay.io/thanos/thanos:v0.37.2
    imagePullPolicy: IfNotPresent
    indexHeaderConfig:
      enableLazyReader: true
      lazyDownloadStrategy: lazy
      lazyReaderIdleTimeout: 5m
    logFormat: logfmt
    logLevel: info
    maxTime: -2w
    objectStorageConfig:
      key: thanos.yaml
      name: telemeter-objectstorage
      optional: false
    shardingStrategy:
      shardReplicas: 2
      shards: 3
      type: block
    storageSize: 50GiB
    storeLimitsOptions:
      storeLimitsRequestSamples: 627040000
      storeLimitsRequestSeries: 1000000
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosStore
  metadata:
    creationTimestamp: null
    name: telemeter-2wto90d
    namespace: rhobs-stage
  spec:
    blockConfig:
      blockDiscoveryStrategy: concurrent
      blockFilesConcurrency: 1
      blockMetaFetchConcurrency: 32
    ignoreDeletionMarksDelay: 24h
    image: quay.io/thanos/thanos:v0.37.2
    imagePullPolicy: IfNotPresent
    indexHeaderConfig:
      enableLazyReader: true
      lazyDownloadStrategy: lazy
      lazyReaderIdleTimeout: 5m
    logFormat: logfmt
    logLevel: info
    maxTime: -90d
    minTime: -2w
    objectStorageConfig:
      key: thanos.yaml
      name: telemeter-objectstorage
      optional: false
    shardingStrategy:
      shardReplicas: 2
      shards: 3
      type: block
    storageSize: 100GiB
    storeLimitsOptions:
      storeLimitsRequestSamples: 627040000
      storeLimitsRequestSeries: 1000000
  status: {}
- apiVersion: monitoring.thanos.io/v1alpha1
  kind: ThanosStore
  metadata:
    creationTimestamp: null
    name: telemeter-90dplus
    namespace: rhobs-stage
  spec:
    blockConfig:
      blockDiscoveryStrategy: concurrent
      blockFilesConcurrency: 1
      blockMetaFetchConcurrency: 32
    ignoreDeletionMarksDelay: 24h
    image: quay.io/thanos/thanos:v0.37.2
    imagePullPolicy: IfNotPresent
    indexHeaderConfig:
      enableLazyReader: true
      lazyDownloadStrategy: lazy
      lazyReaderIdleTimeout: 5m
    logFormat: logfmt
    logLevel: info
    minTime: -90d
    objectStorageConfig:
      key: thanos.yaml
      name: telemeter-objectstorage
      optional: false
    shardingStrategy:
      shardReplicas: 2
      shards: 3
      type: block
    storageSize: 100GiB
    storeLimitsOptions:
      storeLimitsRequestSamples: 627040000
      storeLimitsRequestSeries: 1000000
  status: {}
