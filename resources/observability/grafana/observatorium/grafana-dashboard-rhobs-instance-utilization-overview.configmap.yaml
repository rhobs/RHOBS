apiVersion: v1
data:
  rhobs-instance-utlization-overview.json: |-
    {
     "annotations": {
      "list": [

      ]
     },
     "editable": true,
     "gnetId": null,
     "graphTooltip": 0,
     "hideControls": false,
     "links": [

     ],
     "refresh": "10s",
     "rows": [
      {
       "collapse": false,
       "height": "250px",
       "panels": [
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows rate of requests against Receive for the given time",
         "fill": 10,
         "id": 1,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [
          {
           "alias": "/1../",
           "color": "#EAB839"
          },
          {
           "alias": "/2../",
           "color": "#37872D"
          },
          {
           "alias": "/3../",
           "color": "#E0B400"
          },
          {
           "alias": "/4../",
           "color": "#1F60C4"
          },
          {
           "alias": "/5../",
           "color": "#C4162A"
          }
         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (namespace,  job, handler, code) (rate(http_requests_total{namespace=\"$namespace\", job=~\"observatorium-thanos-receive.*\", handler=\"receive\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{namespace}} {{job}} {{handler}} {{code}}",
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Rate of requests",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {
          "error": "#E24D42"
         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows ratio of errors compared to the total number of handled requests against Receive.",
         "fill": 10,
         "id": 2,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (namespace, job, code) (rate(http_requests_total{namespace=\"$namespace\", job=~\"observatorium-thanos-receive.*\", handler=\"receive\",code=~\"5..\"}[$interval])) / ignoring (code) group_left() sum by (namespace, job) (rate(http_requests_total{namespace=\"$namespace\", job=~\"observatorium-thanos-receive.*\", handler=\"receive\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Errors",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "percentunit",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows how long has it taken to handle requests in quantiles.",
         "fill": 1,
         "id": 3,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [
          {
           "alias": "p99",
           "color": "#FA6400",
           "fill": 1,
           "fillGradient": 1
          },
          {
           "alias": "p90",
           "color": "#E0B400",
           "fill": 1,
           "fillGradient": 1
          },
          {
           "alias": "p50",
           "color": "#37872D",
           "fill": 10,
           "fillGradient": 0
          }
         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "histogram_quantile(0.50, sum by (namespace, job, le) (rate(http_request_duration_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-receive.*\", handler=\"receive\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p50 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.90, sum by (namespace, job, le) (rate(http_request_duration_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-receive.*\", handler=\"receive\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p90 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.99, sum by (namespace, job, le) (rate(http_request_duration_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-receive.*\", handler=\"receive\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p99 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Duration",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "s",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows the number of replication requests against Receive.",
         "fill": 10,
         "id": 4,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [
          {
           "alias": "/Aborted/",
           "color": "#EAB839"
          },
          {
           "alias": "/AlreadyExists/",
           "color": "#37872D"
          },
          {
           "alias": "/FailedPrecondition/",
           "color": "#E0B400"
          },
          {
           "alias": "/Unimplemented/",
           "color": "#E0B400"
          },
          {
           "alias": "/InvalidArgument/",
           "color": "#1F60C4"
          },
          {
           "alias": "/NotFound/",
           "color": "#1F60C4"
          },
          {
           "alias": "/PermissionDenied/",
           "color": "#1F60C4"
          },
          {
           "alias": "/Unauthenticated/",
           "color": "#1F60C4"
          },
          {
           "alias": "/Canceled/",
           "color": "#C4162A"
          },
          {
           "alias": "/DataLoss/",
           "color": "#C4162A"
          },
          {
           "alias": "/DeadlineExceeded/",
           "color": "#C4162A"
          },
          {
           "alias": "/Internal/",
           "color": "#C4162A"
          },
          {
           "alias": "/OutOfRange/",
           "color": "#C4162A"
          },
          {
           "alias": "/ResourceExhausted/",
           "color": "#C4162A"
          },
          {
           "alias": "/Unavailable/",
           "color": "#C4162A"
          },
          {
           "alias": "/Unknown/",
           "color": "#C4162A"
          },
          {
           "alias": "/OK/",
           "color": "#37872D"
          },
          {
           "alias": "error",
           "color": "#C4162A"
          }
         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (namespace,  job, grpc_method, grpc_code) (rate(grpc_client_handled_total{grpc_type=\"unary\", grpc_method=\"RemoteWrite\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{namespace}} {{job}} {{grpc_method}} {{grpc_code}}",
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Replication request count",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows how long has it taken to handle replication requests in quantiles.",
         "fill": 1,
         "id": 5,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [
          {
           "alias": "p99",
           "color": "#FA6400",
           "fill": 1,
           "fillGradient": 1
          },
          {
           "alias": "p90",
           "color": "#E0B400",
           "fill": 1,
           "fillGradient": 1
          },
          {
           "alias": "p50",
           "color": "#37872D",
           "fill": 10,
           "fillGradient": 0
          }
         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "histogram_quantile(0.50, sum by (namespace, job, le) (rate(grpc_client_handling_seconds_bucket{grpc_type=\"unary\", grpc_method=\"RemoteWrite\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p50 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.90, sum by (namespace, job, le) (rate(grpc_client_handling_seconds_bucket{grpc_type=\"unary\", grpc_method=\"RemoteWrite\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p90 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.99, sum by (namespace, job, le) (rate(grpc_client_handling_seconds_bucket{grpc_type=\"unary\", grpc_method=\"RemoteWrite\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p99 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Replication request duration",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "s",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {
          "error": "#E24D42"
         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows the number of replication request errors.",
         "fill": 10,
         "id": 6,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (namespace, job, grpc_code) (rate(grpc_client_handled_total{grpc_code=~\"Unknown|ResourceExhausted|Internal|Unavailable|DataLoss\",grpc_type=\"unary\", grpc_method=\"RemoteWrite\"}[$interval])) / ignoring (grpc_code) group_left() sum by (namespace, job) (rate(grpc_client_handled_total{grpc_type=\"unary\", grpc_method=\"RemoteWrite\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Replication request errors",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "percentunit",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "id": 7,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "max by (pod) (http_inflight_requests{handler=\"receive\", namespace=\"$namespace\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "concurrency gate used {{pod}}",
           "legendLink": null,
           "step": 10
          },
          {
           "expr": "max by (pod) (thanos_receive_write_request_concurrency_write_request_limit{namespace=\"$namespace\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "concurrency gate limit {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Concurrency gate utilization",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Memory working set",
         "fill": 10,
         "id": 8,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "(container_memory_working_set_bytes{container=\"thanos-receive\", namespace=\"$namespace\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "memory usage system {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Memory Used",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "bytes",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "id": 9,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "rate(process_cpu_seconds_total{job=\"observatorium-thanos-receive-default\", namespace=\"$namespace\"}[$interval]) * 100",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "cpu usage system {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "CPU Usage",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "id": 10,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (pod) (kube_pod_container_status_restarts_total{namespace=\"$namespace\", container=\"thanos-receive\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "pod restart count {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Pod/Container Restarts",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 10,
         "id": 11,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Receive",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Receive",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (pod) (rate(container_network_receive_bytes_total{namespace=\"$namespace\", pod=~\"observatorium-thanos-receive-.*\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "network traffic in {{pod}}",
           "legendLink": null,
           "step": 10
          },
          {
           "expr": "sum by (pod) (rate(container_network_transmit_bytes_total{namespace=\"$namespace\", pod=~\"observatorium-thanos-receive-.*\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "network traffic out {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Network Traffic",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "binBps",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        }
       ],
       "repeat": null,
       "repeatIteration": null,
       "repeatRowId": null,
       "showTitle": true,
       "title": "Receive Overview",
       "titleSize": "h6"
      },
      {
       "collapse": false,
       "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
       },
       "height": "250px",
       "panels": [
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows rate of requests against Query Frontend for the given time.",
         "fill": 10,
         "id": 12,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [
          {
           "alias": "/1../",
           "color": "#EAB839"
          },
          {
           "alias": "/2../",
           "color": "#37872D"
          },
          {
           "alias": "/3../",
           "color": "#E0B400"
          },
          {
           "alias": "/4../",
           "color": "#1F60C4"
          },
          {
           "alias": "/5../",
           "color": "#C4162A"
          }
         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (namespace,  job, handler, code) (rate(http_requests_total{namespace=\"$namespace\", job=~\"observatorium-thanos-query-frontend\", handler=\"query-frontend\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{namespace}} {{job}} {{handler}} {{code}}",
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Rate of requests",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {
          "error": "#E24D42"
         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows ratio of errors compared to the total number of handled requests against Query Frontend.",
         "fill": 10,
         "id": 13,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (namespace, job, code) (rate(http_requests_total{namespace=\"$namespace\", job=~\"observatorium-thanos-query-frontend\", handler=\"query-frontend\",code=~\"5..\"}[$interval])) / ignoring (code) group_left() sum by (namespace, job) (rate(http_requests_total{namespace=\"$namespace\", job=~\"observatorium-thanos-query-frontend\", handler=\"query-frontend\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Errors",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "percentunit",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows how long has it taken to handle requests in quantiles.",
         "fill": 1,
         "id": 14,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [
          {
           "alias": "p99",
           "color": "#FA6400",
           "fill": 1,
           "fillGradient": 1
          },
          {
           "alias": "p90",
           "color": "#E0B400",
           "fill": 1,
           "fillGradient": 1
          },
          {
           "alias": "p50",
           "color": "#37872D",
           "fill": 10,
           "fillGradient": 0
          }
         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "histogram_quantile(0.50, sum by (namespace, job, le) (rate(http_request_duration_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-query-frontend\", handler=\"query-frontend\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p50 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.90, sum by (namespace, job, le) (rate(http_request_duration_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-query-frontend\", handler=\"query-frontend\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p90 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.99, sum by (namespace, job, le) (rate(http_request_duration_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-query-frontend\", handler=\"query-frontend\"}[$interval]))) * 1",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p99 {{namespace}} {{job}}",
           "logBase": 10,
           "max": null,
           "min": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Duration",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "s",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 10,
         "id": 15,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 0,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": true,
         "steppedLine": false,
         "targets": [
          {
           "expr": "(container_memory_working_set_bytes{container=\"thanos-query-frontend\", namespace=\"$namespace\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "memory usage system {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Memory Used",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "bytes",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "id": 16,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "rate(process_cpu_seconds_total{job=\"observatorium-thanos-query-frontend\", namespace=\"$namespace\"}[$interval]) * 100",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "cpu usage system {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "CPU Usage",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "id": 17,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "increase(kube_pod_container_status_restarts_total{namespace=\"$namespace\", container='thanos-query-frontend'}[$interval])",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "pod {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Pod/Container Restarts",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "id": 18,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "rate(container_network_receive_bytes_total{namespace=\"$namespace\", pod=~\"observatorium-thanos-query-frontend-.*\"}[$interval])",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "receive bytes pod {{pod}}",
           "legendLink": null,
           "step": 10
          },
          {
           "expr": "rate(container_network_transmit_bytes_total{namespace=\"$namespace\", pod=~\"observatorium-thanos-query-frontend-.*\"}[$interval])",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "transmit bytes pod {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Network Usage",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "binBps",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        }
       ],
       "repeat": null,
       "repeatIteration": null,
       "repeatRowId": null,
       "showTitle": true,
       "title": "Query Frontend Overview",
       "titleSize": "h6"
      },
      {
       "collapse": false,
       "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 8
       },
       "height": "250px",
       "panels": [
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Displays the rate of total rule evaluations,",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 0,
          "y": 9
         },
         "id": 19,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Rule",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Rule",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (job, rule_group) (rate(prometheus_rule_evaluations_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{rule_group}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Total evaluations",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Displays the rate of rule evaluation failures, grouped by rule group.",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 6,
          "y": 9
         },
         "id": 20,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Rule",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Rule",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (job, rule_group) (rate(prometheus_rule_evaluation_failures_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{rule_group}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Failed evaluations",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 12,
          "y": 9
         },
         "id": 21,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Rule",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Rule",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (job, strategy) (rate(thanos_rule_evaluation_with_warnings_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{rule_group}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Evaluations with warnings",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Displays the total time of rule group evaluations that took longer than their scheduled interval.",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 18,
          "y": 9
         },
         "id": 22,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Rule",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Rule",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by(job, rule_group) (prometheus_rule_group_last_duration_seconds{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}) / sum by(job, rule_group) (prometheus_rule_group_interval_seconds{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{rule_group}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Too slow evaluations",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Shows the rate of total alerts sent by Thanos.",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 0,
          "y": 15
         },
         "id": 23,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Rule",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Rule",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (job) (rate(thanos_alert_sender_alerts_sent_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{job}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Rate of sent alerts",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Displays the ratio of error rate to total alerts sent rate by Thanos.",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 6,
          "y": 15
         },
         "id": 24,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Rule",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Rule",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "sum by (job) (rate(thanos_alert_sender_errors_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval])) / sum by (job) (rate(thanos_alert_sender_alerts_sent_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{job}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Rate of send alerts errors",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "description": "Displays the 50th, 90th, and 99th percentile latency of alert requests sent by Thanos.",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 12,
          "y": 15
         },
         "id": 25,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "histogram_quantile(0.50, sum by (job, le) (rate(thanos_alert_sender_latency_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval])))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p50",
           "legendLink": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.90, sum by (job, le) (rate(thanos_alert_sender_latency_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval])))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p90",
           "legendLink": null,
           "step": 10
          },
          {
           "expr": "histogram_quantile(0.99, sum by (job, le) (rate(thanos_alert_sender_latency_seconds_bucket{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval])))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "p99",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Duration od send alerts",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 0,
          "y": 21
         },
         "id": 26,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "(container_memory_working_set_bytes{container=\"thanos-rule\", namespace=\"$namespace\"}) / (1024 * 1024)",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "memory usage system {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Memory Used",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "MB",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 6,
          "y": 21
         },
         "id": 27,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "rate(process_cpu_seconds_total{namespace=\"$namespace\", job=~\"observatorium-thanos-rule\"}[$interval]) * 100",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "cpu usage system {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "CPU Usage",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "percent",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 12,
          "y": 21
         },
         "id": 28,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "rate(container_network_receive_bytes_total{namespace=\"$namespace\", pod=~\"observatorium-thanos-rule.*\"}[$interval]) / (1024 * 1024)",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "receive bytes pod {{pod}}",
           "legendLink": null,
           "step": 10
          },
          {
           "expr": "rate(container_network_transmit_bytes_total{namespace=\"$namespace\", pod=~\"observatorium-thanos-rule.*\"}[$interval]) / (1024 * 1024)",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "transmit bytes pod {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Network Usage",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "MB",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        },
        {
         "aliasColors": {

         },
         "bars": false,
         "dashLength": 10,
         "dashes": false,
         "datasource": "$datasource",
         "fill": 1,
         "gridPos": {
          "h": 6,
          "w": 6,
          "x": 18,
          "y": 21
         },
         "id": 29,
         "legend": {
          "avg": false,
          "current": false,
          "max": false,
          "min": false,
          "show": true,
          "total": false,
          "values": false
         },
         "lines": true,
         "linewidth": 1,
         "links": [
          {
           "dashboard": "Thanos / Query Frontend",
           "includeVars": true,
           "keepTime": true,
           "title": "Thanos / Query Frontend",
           "type": "dashboard"
          }
         ],
         "nullPointMode": "null as zero",
         "percentage": false,
         "pointradius": 5,
         "points": false,
         "renderer": "flot",
         "seriesOverrides": [

         ],
         "spaceLength": 10,
         "span": 1,
         "stack": false,
         "steppedLine": false,
         "targets": [
          {
           "expr": "increase(kube_pod_container_status_restarts_total{namespace=\"$namespace\", container=\"thanos-rule\"}[$interval])",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "pod {{pod}}",
           "legendLink": null,
           "step": 10
          }
         ],
         "thresholds": [

         ],
         "timeFrom": null,
         "timeShift": null,
         "title": "Pod/Container Restarts",
         "tooltip": {
          "shared": false,
          "sort": 0,
          "value_type": "individual"
         },
         "type": "graph",
         "xaxis": {
          "buckets": null,
          "mode": "time",
          "name": null,
          "show": true,
          "values": [

          ]
         },
         "yaxes": [
          {
           "format": "count",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": 0,
           "show": true
          },
          {
           "format": "short",
           "label": null,
           "logBase": 1,
           "max": null,
           "min": null,
           "show": false
          }
         ]
        }
       ],
       "repeat": null,
       "repeatIteration": null,
       "repeatRowId": null,
       "showTitle": true,
       "title": "Thanos Rule Overview",
       "titleSize": "h6"
      }
     ],
     "schemaVersion": 14,
     "style": "dark",
     "tags": [

     ],
     "templating": {
      "list": [
       {
        "current": {
         "text": "default",
         "value": "default"
        },
        "hide": 0,
        "label": null,
        "name": "datasource",
        "options": [

        ],
        "query": "prometheus",
        "refresh": 1,
        "regex": "",
        "type": "datasource"
       },
       {
        "allValue": ".+",
        "current": {
         "text": "",
         "value": ""
        },
        "datasource": "$datasource",
        "hide": 0,
        "includeAll": true,
        "label": "namespace",
        "multi": false,
        "name": "namespace",
        "options": [

        ],
        "query": "label_values(thanos_status, namespace)",
        "refresh": 2,
        "regex": "",
        "sort": 1,
        "tagValuesQuery": "",
        "tags": [

        ],
        "tagsQuery": "",
        "type": "query",
        "useTags": false
       },
       {
        "auto": true,
        "auto_count": 300,
        "auto_min": "10s",
        "current": {
         "text": "5m",
         "value": "5m"
        },
        "hide": 0,
        "label": "interval",
        "name": "interval",
        "query": "5m,10m,30m,1h,6h,12h",
        "refresh": 2,
        "type": "interval"
       }
      ]
     },
     "time": {
      "from": "now-1h",
      "to": "now"
     },
     "timepicker": {
      "refresh_intervals": [
       "5s",
       "10s",
       "30s",
       "1m",
       "5m",
       "15m",
       "30m",
       "1h",
       "2h",
       "1d"
      ],
      "time_options": [
       "5m",
       "15m",
       "1h",
       "6h",
       "12h",
       "24h",
       "2d",
       "7d",
       "30d"
      ]
     },
     "timezone": "utc",
     "title": "RHOBS Instance Utilization Overview",
     "uid": "",
     "version": 0
    }
kind: ConfigMap
metadata:
  annotations:
    grafana-folder: /grafana-dashboard-definitions/Observatorium
  labels:
    grafana_dashboard: "true"
  name: grafana-dashboard-rhobs-instance-utlization
